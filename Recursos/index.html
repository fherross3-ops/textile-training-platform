<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Capacitación Textil</title>
    <style>
        /* [TODOS TUS ESTILOS ACTUALES] */
        /* Mantén todos tus estilos actuales aquí */
    </style>
    <!-- Librerías para exportación -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Plataforma de Capacitación Textil</h1>
        
        <div class="tabs">
            <div class="tab active" data-tab="kpi">Diseño de KPI</div>
            <div class="tab" data-tab="examples">Ejemplos de KPI</div>
            <div class="tab" data-tab="resources">Recursos</div>
        </div>
        
        <div id="alertBox" class="alert"></div>
        
        <!-- Pestaña de KPI -->
        <div id="kpiTab" class="tab-content active">
            <!-- Formulario principal para Netlify -->
            <form id="kpiForm" name="kpi" netlify netlify-honeypot="bot-field" data-netlify="true">
                <!-- Campo honeypot para protección contra bots -->
                <p class="hidden">
                    <label>No llenar este campo: <input name="bot-field"/></label>
                </p>
                
                <!-- Sección 1: Información básica del KPI -->
                <div class="form-section">
                    <h2>Información Básica del KPI</h2>
                    
                    <div class="form-group">
                        <label for="kpiName" class="required">Nombre del KPI</label>
                        <input type="text" id="kpiName" name="kpiName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="kpiDescription" class="required">Descripción del KPI</label>
                        <textarea id="kpiDescription" name="kpiDescription" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="kpiObjective" class="required">Objetivo del KPI</label>
                        <textarea id="kpiObjective" name="kpiObjective" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="required">Proceso asociado</label>
                        <div class="process-selector">
                            <div class="process-item" data-process="planeacion">Planeación</div>
                            <div class="process-item" data-process="compras">Compras</div>
                            <div class="process-item" data-process="produccion">Producción</div>
                            <div class="process-item" data-process="calidad">Control de Calidad</div>
                            <div class="process-item" data-process="mantenimiento">Mantenimiento</div>
                            <div class="process-item" data-process="logistica">Logística</div>
                            <div class="process-item" data-process="ventas">Ventas</div>
                            <div class="process-item" data-process="innovacion">Innovación y Desarrollo</div>
                        </div>
                        <input type="hidden" id="selectedProcess" name="selectedProcess" required>
                    </div>
                </div>
                
                <!-- Sección 2: Especificaciones Técnicas -->
                <div class="form-section">
                    <h2>Especificaciones Técnicas</h2>
                    
                    <div class="form-group">
                        <label for="variables" class="required">Variables a medir</label>
                        <input type="text" id="variables" name="variables" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="measurementUnit" class="required">Unidad de medida</label>
                                <input type="text" id="measurementUnit" name="measurementUnit" required>
                            </div>
                        </div>
                        
                        <div class="form-col">
                            <div class="form-group">
                                <label for="formula" class="required">Fórmula de cálculo</label>
                                <input type="text" id="formula" name="formula" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="frequency" class="required">Frecuencia de medición</label>
                                <select id="frequency" name="frequency" required>
                                    <option value="">Seleccione una opción</option>
                                    <option value="diaria">Diaria</option>
                                    <option value="semanal">Semanal</option>
                                    <option value="quincenal">Quincenal</option>
                                    <option value="mensual">Mensual</option>
                                    <option value="trimestral">Trimestral</option>
                                    <option value="semestral">Semestral</option>
                                    <option value="anual">Anual</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-col">
                            <div class="form-group">
                                <label for="targetValue" class="required">Valor objetivo</label>
                                <input type="number" id="targetValue" name="targetValue" step="0.01" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="minValue">Valor mínimo aceptable</label>
                                <input type="number" id="minValue" name="minValue" step="0.01">
                            </div>
                        </div>
                        
                        <div class="form-col">
                            <div class="form-group">
                                <label for="maxValue">Valor máximo aceptable</label>
                                <input type="number" id="maxValue" name="maxValue" step="0.01">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="toleranceRange">Rango de tolerancia</label>
                        <input type="text" id="toleranceRange" name="toleranceRange">
                    </div>
                    
                    <div class="form-group">
                        <label class="required">Sistema gráfico para visualización</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="grafico-lineas" name="sisgoGrafico" value="lineas" required>
                                <label for="grafico-lineas">Gráfico de líneas</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="grafico-barras" name="sisgoGrafico" value="barras">
                                <label for="grafico-barras">Gráfico de barras</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="grafico-torta" name="sisgoGrafico" value="torta">
                                <label for="grafico-torta">Gráfico de torta</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Sección 3: Utilidad y Aplicación -->
                <div class="form-section">
                    <h2>Utilidad y Aplicación</h2>
                    
                    <div class="form-group">
                        <label for="utilidadComentario" class="required">Comentarios sobre la utilidad del KPI</label>
                        <textarea id="utilidadComentario" name="utilidadComentario" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="designResponsible" class="required">Responsable del diseño</label>
                        <input type="text" id="designResponsible" name="designResponsible" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="implementationResponsible" class="required">Responsable de implementación</label>
                        <input type="text" id="implementationResponsible" name="implementationResponsible" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="monitoringResponsible" class="required">Responsable de monitoreo</label>
                        <input type="text" id="monitoringResponsible" name="monitoringResponsible" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="emailContact" class="required">Email de contacto</label>
                        <input type="email" id="emailContact" name="emailContact" required>
                    </div>
                </div>
                
                <button type="submit" class="btn-primary">Guardar KPI</button>
            </form>
            
            <!-- Botones de acción -->
            <div class="action-buttons">
                <button id="printBtn" class="btn-secondary">Imprimir</button>
                <button id="exportPdfBtn" class="btn-danger">Exportar a PDF</button>
                <button id="exportWordBtn" class="btn-secondary">Exportar a Word</button>
                <button id="exportCsvBtn" class="btn-success">Exportar a CSV</button>
                <button id="importCsvBtn" class="btn-warning">Importar desde CSV</button>
                <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
            </div>
            
            <!-- Repositorio de KPIs guardados -->
            <div class="repository-section">
                <h2>KPIs Guardados</h2>
                <div id="kpiList" class="kpi-list">
                    <!-- Aquí se mostrarán los KPIs guardados -->
                </div>
            </div>
        </div>
        
        <!-- [RESTANTE DEL CÓDIGO PARA EJEMPLOS Y RECURSOS] -->
        <!-- Mantén las secciones de ejemplos y recursos -->
    </div>

    <script>
        // Mapeo de nombres de procesos
        const processNames = {
            'planeacion': 'Planeación',
            'compras': 'Compras',
            'produccion': 'Producción',
            'calidad': 'Control de Calidad',
            'mantenimiento': 'Mantenimiento',
            'logistica': 'Logística',
            'ventas': 'Ventas',
            'innovacion': 'Innovación y Desarrollo'
        };

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar selectores de proceso
            const processItems = document.querySelectorAll('.process-item');
            processItems.forEach(item => {
                item.addEventListener('click', function() {
                    processItems.forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('selectedProcess').value = this.getAttribute('data-process');
                });
            });

            // Configurar pestañas
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Desactivar todas las pestañas
                    tabs.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
                    
                    // Activar la pestaña seleccionada
                    this.classList.add('active');
                    document.getElementById(tabName + 'Tab').classList.add('active');
                });
            });

            // Configurar botones de acción
            document.getElementById('printBtn').addEventListener('click', function() {
                window.print();
            });

            document.getElementById('exportPdfBtn').addEventListener('click', exportToPdf);
            document.getElementById('exportWordBtn').addEventListener('click', exportToWord);
            document.getElementById('exportCsvBtn').addEventListener('click', exportToCsv);
            document.getElementById('importCsvBtn').addEventListener('click', function() {
                document.getElementById('csvFileInput').click();
            });
            
            document.getElementById('csvFileInput').addEventListener('change', importFromCsv);

            // Cargar KPIs guardados
            loadSavedKpis();

            // Configurar envío del formulario
            document.getElementById('kpiForm').addEventListener('submit', function(e) {
                e.preventDefault();
                if (validateForm()) {
                    // Guardar en localStorage
                    saveKpi();
                    
                    // Mostrar mensaje de éxito
                    showAlert('KPI guardado correctamente. Enviando formulario a Netlify...', 'success');
                    
                    // Enviar formulario a Netlify después de un breve retraso
                    setTimeout(() => {
                        this.submit();
                    }, 2000);
                }
            });
        });

        // [EL RESTO DE TUS FUNCIONES JAVASCRIPT]
        // Mantén todas tus funciones JavaScript actuales

    </script>
</body>
</html>
